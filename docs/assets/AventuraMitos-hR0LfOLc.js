import{j as t}from"./index-CRs1o41v.js";import{r as S}from"./react-Disfgg3A.js";import{L as Se}from"./lottie-C3beRD-s.js";import{s as Pe}from"./star-BTWoxSKi.js";import{a as U}from"./adventureData-Bi463Fqu.js";import{a as ke,s as Ee}from"./progress-BBVrwzPV.js";import{j as Ie,k as ze,S as te,B as X,l as z,m as Q}from"./ui-Dc_M8Cgp.js";var ae={};(function f(m,M,C,b){var k=!!(m.Worker&&m.Blob&&m.Promise&&m.OffscreenCanvas&&m.OffscreenCanvasRenderingContext2D&&m.HTMLCanvasElement&&m.HTMLCanvasElement.prototype.transferControlToOffscreen&&m.URL&&m.URL.createObjectURL),D=typeof Path2D=="function"&&typeof DOMMatrix=="function",L=(function(){if(!m.OffscreenCanvas)return!1;try{var r=new OffscreenCanvas(1,1),e=r.getContext("2d");e.fillRect(0,0,1,1);var s=r.transferToImageBitmap();e.createPattern(s,"no-repeat")}catch{return!1}return!0})();function F(){}function E(r){var e=M.exports.Promise,s=e!==void 0?e:m.Promise;return typeof s=="function"?new s(r):(r(F,F),null)}var N=(function(r,e){return{transform:function(s){if(r)return s;if(e.has(s))return e.get(s);var i=new OffscreenCanvas(s.width,s.height),o=i.getContext("2d");return o.drawImage(s,0,0),e.set(s,i),i},clear:function(){e.clear()}}})(L,new Map),O=(function(){var r=Math.floor(16.666666666666668),e,s,i={},o=0;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(e=function(l){var c=Math.random();return i[c]=requestAnimationFrame(function n(d){o===d||o+r-1<d?(o=d,delete i[c],l()):i[c]=requestAnimationFrame(n)}),c},s=function(l){i[l]&&cancelAnimationFrame(i[l])}):(e=function(l){return setTimeout(l,r)},s=function(l){return clearTimeout(l)}),{frame:e,cancel:s}})(),H=(function(){var r,e,s={};function i(o){function l(c,n){o.postMessage({options:c||{},callback:n})}o.init=function(n){var d=n.transferControlToOffscreen();o.postMessage({canvas:d},[d])},o.fire=function(n,d,x){if(e)return l(n,null),e;var y=Math.random().toString(36).slice(2);return e=E(function(v){function w(P){P.data.callback===y&&(delete s[y],o.removeEventListener("message",w),e=null,N.clear(),x(),v())}o.addEventListener("message",w),l(n,y),s[y]=w.bind(null,{data:{callback:y}})}),e},o.reset=function(){o.postMessage({reset:!0});for(var n in s)s[n](),delete s[n]}}return function(){if(r)return r;if(!C&&k){var o=["var CONFETTI, SIZE = {}, module = {};","("+f.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {","  if (msg.data.options) {","    CONFETTI(msg.data.options).then(function () {","      if (msg.data.callback) {","        postMessage({ callback: msg.data.callback });","      }","    });","  } else if (msg.data.reset) {","    CONFETTI && CONFETTI.reset();","  } else if (msg.data.resize) {","    SIZE.width = msg.data.resize.width;","    SIZE.height = msg.data.resize.height;","  } else if (msg.data.canvas) {","    SIZE.width = msg.data.canvas.width;","    SIZE.height = msg.data.canvas.height;","    CONFETTI = module.exports.create(msg.data.canvas);","  }","}"].join(`
`);try{r=new Worker(URL.createObjectURL(new Blob([o])))}catch(l){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("ðŸŽŠ Could not load worker",l),null}i(r)}return r}})(),V={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!1,scalar:1};function G(r,e){return e?e(r):r}function _(r){return r!=null}function h(r,e,s){return G(r&&_(r[e])?r[e]:V[e],s)}function J(r){return r<0?0:Math.floor(r)}function Z(r,e){return Math.floor(Math.random()*(e-r))+r}function q(r){return parseInt(r,16)}function K(r){return r.map(p)}function p(r){var e=String(r).replace(/[^0-9a-f]/gi,"");return e.length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),{r:q(e.substring(0,2)),g:q(e.substring(2,4)),b:q(e.substring(4,6))}}function a(r){var e=h(r,"origin",Object);return e.x=h(e,"x",Number),e.y=h(e,"y",Number),e}function g(r){r.width=document.documentElement.clientWidth,r.height=document.documentElement.clientHeight}function j(r){var e=r.getBoundingClientRect();r.width=e.width,r.height=e.height}function Y(r){var e=document.createElement("canvas");return e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.pointerEvents="none",e.style.zIndex=r,e}function ue(r,e,s,i,o,l,c,n,d){r.save(),r.translate(e,s),r.rotate(l),r.scale(i,o),r.arc(0,0,1,c,n,d),r.restore()}function me(r){var e=r.angle*(Math.PI/180),s=r.spread*(Math.PI/180);return{x:r.x,y:r.y,wobble:Math.random()*10,wobbleSpeed:Math.min(.11,Math.random()*.1+.05),velocity:r.startVelocity*.5+Math.random()*r.startVelocity,angle2D:-e+(.5*s-Math.random()*s),tiltAngle:(Math.random()*(.75-.25)+.25)*Math.PI,color:r.color,shape:r.shape,tick:0,totalTicks:r.ticks,decay:r.decay,drift:r.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:r.gravity*3,ovalScalar:.6,scalar:r.scalar,flat:r.flat}}function fe(r,e){e.x+=Math.cos(e.angle2D)*e.velocity+e.drift,e.y+=Math.sin(e.angle2D)*e.velocity+e.gravity,e.velocity*=e.decay,e.flat?(e.wobble=0,e.wobbleX=e.x+10*e.scalar,e.wobbleY=e.y+10*e.scalar,e.tiltSin=0,e.tiltCos=0,e.random=1):(e.wobble+=e.wobbleSpeed,e.wobbleX=e.x+10*e.scalar*Math.cos(e.wobble),e.wobbleY=e.y+10*e.scalar*Math.sin(e.wobble),e.tiltAngle+=.1,e.tiltSin=Math.sin(e.tiltAngle),e.tiltCos=Math.cos(e.tiltAngle),e.random=Math.random()+2);var s=e.tick++/e.totalTicks,i=e.x+e.random*e.tiltCos,o=e.y+e.random*e.tiltSin,l=e.wobbleX+e.random*e.tiltCos,c=e.wobbleY+e.random*e.tiltSin;if(r.fillStyle="rgba("+e.color.r+", "+e.color.g+", "+e.color.b+", "+(1-s)+")",r.beginPath(),D&&e.shape.type==="path"&&typeof e.shape.path=="string"&&Array.isArray(e.shape.matrix))r.fill(pe(e.shape.path,e.shape.matrix,e.x,e.y,Math.abs(l-i)*.1,Math.abs(c-o)*.1,Math.PI/10*e.wobble));else if(e.shape.type==="bitmap"){var n=Math.PI/10*e.wobble,d=Math.abs(l-i)*.1,x=Math.abs(c-o)*.1,y=e.shape.bitmap.width*e.scalar,v=e.shape.bitmap.height*e.scalar,w=new DOMMatrix([Math.cos(n)*d,Math.sin(n)*d,-Math.sin(n)*x,Math.cos(n)*x,e.x,e.y]);w.multiplySelf(new DOMMatrix(e.shape.matrix));var P=r.createPattern(N.transform(e.shape.bitmap),"no-repeat");P.setTransform(w),r.globalAlpha=1-s,r.fillStyle=P,r.fillRect(e.x-y/2,e.y-v/2,y,v),r.globalAlpha=1}else if(e.shape==="circle")r.ellipse?r.ellipse(e.x,e.y,Math.abs(l-i)*e.ovalScalar,Math.abs(c-o)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI):ue(r,e.x,e.y,Math.abs(l-i)*e.ovalScalar,Math.abs(c-o)*e.ovalScalar,Math.PI/10*e.wobble,0,2*Math.PI);else if(e.shape==="star")for(var u=Math.PI/2*3,I=4*e.scalar,T=8*e.scalar,R=e.x,B=e.y,W=5,A=Math.PI/W;W--;)R=e.x+Math.cos(u)*T,B=e.y+Math.sin(u)*T,r.lineTo(R,B),u+=A,R=e.x+Math.cos(u)*I,B=e.y+Math.sin(u)*I,r.lineTo(R,B),u+=A;else r.moveTo(Math.floor(e.x),Math.floor(e.y)),r.lineTo(Math.floor(e.wobbleX),Math.floor(o)),r.lineTo(Math.floor(l),Math.floor(c)),r.lineTo(Math.floor(i),Math.floor(e.wobbleY));return r.closePath(),r.fill(),e.tick<e.totalTicks}function he(r,e,s,i,o){var l=e.slice(),c=r.getContext("2d"),n,d,x=E(function(y){function v(){n=d=null,c.clearRect(0,0,i.width,i.height),N.clear(),o(),y()}function w(){C&&!(i.width===b.width&&i.height===b.height)&&(i.width=r.width=b.width,i.height=r.height=b.height),!i.width&&!i.height&&(s(r),i.width=r.width,i.height=r.height),c.clearRect(0,0,i.width,i.height),l=l.filter(function(P){return fe(c,P)}),l.length?n=O.frame(w):v()}n=O.frame(w),d=v});return{addFettis:function(y){return l=l.concat(y),x},canvas:r,promise:x,reset:function(){n&&O.cancel(n),d&&d()}}}function se(r,e){var s=!r,i=!!h(e||{},"resize"),o=!1,l=h(e,"disableForReducedMotion",Boolean),c=k&&!!h(e||{},"useWorker"),n=c?H():null,d=s?g:j,x=r&&n?!!r.__confetti_initialized:!1,y=typeof matchMedia=="function"&&matchMedia("(prefers-reduced-motion)").matches,v;function w(u,I,T){for(var R=h(u,"particleCount",J),B=h(u,"angle",Number),W=h(u,"spread",Number),A=h(u,"startVelocity",Number),ge=h(u,"decay",Number),be=h(u,"gravity",Number),ye=h(u,"drift",Number),ie=h(u,"colors",K),we=h(u,"ticks",Number),oe=h(u,"shapes"),je=h(u,"scalar"),Me=!!h(u,"flat"),le=a(u),ce=R,re=[],Ce=r.width*le.x,Ne=r.height*le.y;ce--;)re.push(me({x:Ce,y:Ne,angle:B,spread:W,startVelocity:A,color:ie[ce%ie.length],shape:oe[Z(0,oe.length)],ticks:we,decay:ge,gravity:be,drift:ye,scalar:je,flat:Me}));return v?v.addFettis(re):(v=he(r,re,d,I,T),v.promise)}function P(u){var I=l||h(u,"disableForReducedMotion",Boolean),T=h(u,"zIndex",Number);if(I&&y)return E(function(A){A()});s&&v?r=v.canvas:s&&!r&&(r=Y(T),document.body.appendChild(r)),i&&!x&&d(r);var R={width:r.width,height:r.height};n&&!x&&n.init(r),x=!0,n&&(r.__confetti_initialized=!0);function B(){if(n){var A={getBoundingClientRect:function(){if(!s)return r.getBoundingClientRect()}};d(A),n.postMessage({resize:{width:A.width,height:A.height}});return}R.width=R.height=null}function W(){v=null,i&&(o=!1,m.removeEventListener("resize",B)),s&&r&&(document.body.contains(r)&&document.body.removeChild(r),r=null,x=!1)}return i&&!o&&(o=!0,m.addEventListener("resize",B,!1)),n?n.fire(u,R,W):w(u,R,W)}return P.reset=function(){n&&n.reset(),v&&v.reset()},P}var ee;function ne(){return ee||(ee=se(null,{useWorker:!0,resize:!0})),ee}function pe(r,e,s,i,o,l,c){var n=new Path2D(r),d=new Path2D;d.addPath(n,new DOMMatrix(e));var x=new Path2D;return x.addPath(d,new DOMMatrix([Math.cos(c)*o,Math.sin(c)*o,-Math.sin(c)*l,Math.cos(c)*l,s,i])),x}function xe(r){if(!D)throw new Error("path confetti are not supported in this browser");var e,s;typeof r=="string"?e=r:(e=r.path,s=r.matrix);var i=new Path2D(e),o=document.createElement("canvas"),l=o.getContext("2d");if(!s){for(var c=1e3,n=c,d=c,x=0,y=0,v,w,P=0;P<c;P+=2)for(var u=0;u<c;u+=2)l.isPointInPath(i,P,u,"nonzero")&&(n=Math.min(n,P),d=Math.min(d,u),x=Math.max(x,P),y=Math.max(y,u));v=x-n,w=y-d;var I=10,T=Math.min(I/v,I/w);s=[T,0,0,T,-Math.round(v/2+n)*T,-Math.round(w/2+d)*T]}return{type:"path",path:e,matrix:s}}function ve(r){var e,s=1,i="#000000",o='"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji", "EmojiOne Color", "Android Emoji", "Twemoji Mozilla", "system emoji", sans-serif';typeof r=="string"?e=r:(e=r.text,s="scalar"in r?r.scalar:s,o="fontFamily"in r?r.fontFamily:o,i="color"in r?r.color:i);var l=10*s,c=""+l+"px "+o,n=new OffscreenCanvas(l,l),d=n.getContext("2d");d.font=c;var x=d.measureText(e),y=Math.ceil(x.actualBoundingBoxRight+x.actualBoundingBoxLeft),v=Math.ceil(x.actualBoundingBoxAscent+x.actualBoundingBoxDescent),w=2,P=x.actualBoundingBoxLeft+w,u=x.actualBoundingBoxAscent+w;y+=w+w,v+=w+w,n=new OffscreenCanvas(y,v),d=n.getContext("2d"),d.font=c,d.fillStyle=i,d.fillText(e,P,u);var I=1/s;return{type:"bitmap",bitmap:n.transferToImageBitmap(),matrix:[I,0,0,I,-y*I/2,-v*I/2]}}M.exports=function(){return ne().apply(this,arguments)},M.exports.reset=function(){ne().reset()},M.exports.create=se,M.exports.shapeFromPath=xe,M.exports.shapeFromText=ve})((function(){return typeof window<"u"?window:typeof self<"u"?self:this||{}})(),ae,!1);const de=ae.exports;ae.exports.create;function Te({active:f}){const m=S.useRef(null);return S.useEffect(()=>{if(!f)return;const C=Date.now()+1200,b=["#ffd93b","#ff6f91","#66d5f7","#8ef6e4"],k=()=>{de({particleCount:40,spread:70,startVelocity:25,gravity:.8,ticks:120,origin:{y:.4},colors:b,scalar:.9}),de({particleCount:25,spread:120,startVelocity:40,origin:{y:.2},colors:b,scalar:.7}),Date.now()<C&&(m.current=requestAnimationFrame(k))};return m.current=requestAnimationFrame(k),()=>{m.current!==null&&(cancelAnimationFrame(m.current),m.current=null)}},[f]),null}const Re={Bienvenida:t.jsx(te,{size:20}),Personalizacion:t.jsx(z,{size:20}),Activacion:t.jsx(z,{size:20}),"Lectura guiada":t.jsx(X,{size:20}),Comprension:t.jsx(X,{size:20}),Creacion:t.jsx(Q,{size:20}),"Creacion visual":t.jsx(Q,{size:20}),Fuentes:t.jsx(z,{size:20}),Escritura:t.jsx(z,{size:20}),Clasificacion:t.jsx(z,{size:20}),"Arte y cultura":t.jsx(Q,{size:20}),"Conciencia ambiental":t.jsx(z,{size:20}),"Arte popular":t.jsx(Q,{size:20}),"Musica y tradicion":t.jsx(Q,{size:20}),"Narracion oral":t.jsx(z,{size:20}),"Conceptos clave":t.jsx(z,{size:20}),"Proceso narrativo":t.jsx(z,{size:20}),Planeacion:t.jsx(z,{size:20}),Autoevaluacion:t.jsx(z,{size:20}),Cierre:t.jsx(te,{size:20}),Gramatica:t.jsx(z,{size:20})},Fe={"Comprension lectora":"Relee el fragmento que menciona la pregunta y subraya las palabras que se repiten.",Creacion:"Piensa en los pasos o materiales que usarÃ­as para crear lo que se pide.","Creacion visual":"Recuerda los colores, sonidos o movimientos que se describen en el texto.",Gramatica:"Identifica la regla gramatical del tema y compara las opciones con esa pista.","Conceptos clave":"Relaciona cada concepto con su definiciÃ³n o con el ejemplo que aparece en la lectura.","Proceso narrativo":"Observa el orden de los sucesos (inicio, desarrollo y final) para elegir la opciÃ³n correcta."},Ae="Vuelve a leer la consigna, busca palabras clave en el texto y descarta las opciones que no las mencionen.",$=U.length;function Ze(){const f=S.useMemo(()=>{const p={};return U.forEach(a=>{const g=ke(`aventura.${a.id}`);g&&g.score>=1&&(p[a.id]={completed:!0,stars:g.stars,attempts:g.attempts})}),p},[]),[m,M]=S.useState(f),[C,b]=S.useState(()=>{const p=U.findIndex(a=>!f[a.id]?.completed);return p===-1?0:p}),[k,D]=S.useState(!1),[L,F]=S.useState(null),E=S.useRef(null);S.useEffect(()=>()=>{E.current&&clearTimeout(E.current)},[]);const N=U[C],O=S.useMemo(()=>{const p={};return U.forEach(a=>{a.type==="reading"&&(p[a.id]=a)}),p},[]),H=U.filter(p=>m[p.id]?.completed).length,V=Object.values(m).reduce((p,a)=>p+a.stars,0),G=U.reduce((p,a)=>p+(a.starValue??3),0),_=Math.round(H/$*100),h=!!m[N.id]?.completed,J=N.type==="multiple-choice"&&N.readingId?O[N.readingId]:void 0,Z=({stars:p,attempts:a})=>{if(m[N.id]?.completed)return;const g={completed:!0,stars:p,attempts:a};M(j=>({...j,[N.id]:g})),F({...g,title:N.title}),Ee(`aventura.${N.id}`,{score:1,stars:p,attempts:a,completedAt:Date.now()}),D(!0),E.current&&clearTimeout(E.current),E.current=window.setTimeout(()=>{D(!1),b(j=>Math.min(j+1,$-1))},1500)},q=()=>b(p=>Math.max(0,p-1)),K=()=>b(p=>Math.min($-1,p+1));return t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx("header",{className:"rounded-[28px] border border-white/70 bg-white p-6 shadow-[0_32px_65px_-48px_rgba(127,107,255,0.9)]",children:t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-primary",children:"Trayecto 1 - Lengua"}),t.jsx("h1",{className:"text-2xl font-semibold text-ink",children:"Aventura paso a paso"}),t.jsxs("p",{className:"text-sm text-muted",children:["Ejercicio ",C+1," de ",$]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"h-2 w-full rounded-full bg-primary/10",children:t.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-primary to-secondary transition-all",style:{width:`${_}%`}})}),t.jsxs("div",{className:"flex items-center justify-between text-xs font-semibold text-muted",children:[t.jsxs("span",{children:[_,"% completado"]}),t.jsxs("span",{children:[V,"/",G," estrellas"]})]})]})]})}),k&&t.jsxs("div",{className:"relative mx-auto flex w-full max-w-sm flex-col items-center gap-3 rounded-[28px] border border-primary/20 bg-white/90 p-6 text-center shadow-[0_32px_75px_-40px_rgba(127,107,255,0.7)]",children:[t.jsx(Te,{active:k}),t.jsx("div",{className:"w-40",children:t.jsx(Se,{animationData:Pe,loop:!1})}),t.jsxs("p",{className:"text-sm font-semibold text-primary",children:["Â¡Genial! Sumaste ",L?.stars??0," ",L?.stars===1?"estrella":"estrellas"," enÂ ",L?.title??"este paso","."]})]}),t.jsx(Oe,{step:N,index:C,total:$,completed:h,children:N.type==="reading"?t.jsx(_e,{step:N,onComplete:()=>Z({stars:N.starValue??3,attempts:1}),completed:h}):t.jsx(Be,{step:N,onSuccess:Z,completed:h,reading:J})}),t.jsxs("footer",{className:"mt-4 flex items-center justify-between",children:[t.jsxs("button",{type:"button",onClick:q,className:"inline-flex items-center gap-2 rounded-full bg-white/70 px-4 py-2 text-sm font-semibold text-primary shadow-[0_18px_35px_-30px_rgba(127,107,255,0.7)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:opacity-40",disabled:C===0,children:[t.jsx(Ie,{size:16})," Anterior"]}),t.jsxs("button",{type:"button",onClick:K,className:"inline-flex items-center gap-2 rounded-full bg-gradient-to-r from-primary to-secondary px-5 py-2 text-sm font-semibold text-white shadow-[0_18px_35px_-18px_rgba(127,107,255,0.8)] focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary disabled:opacity-40",disabled:C===$-1,children:["Siguiente ",t.jsx(ze,{size:16})]})]})]})}function Oe({step:f,index:m,total:M,completed:C,children:b}){const k=Re[f.category]??t.jsx(te,{size:20});return t.jsxs("section",{className:"flex flex-col gap-5 rounded-[26px] border border-white/70 bg-white px-6 py-6 shadow-[0_24px_55px_-48px_rgba(127,107,255,0.8)]",children:[t.jsxs("header",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-primary/15 text-primary",children:k}),t.jsxs("div",{children:[t.jsxs("p",{className:"text-xs font-semibold uppercase tracking-[0.3em] text-muted",children:["Paso ",m+1," de ",M]}),t.jsx("h2",{className:"text-xl font-semibold text-ink",children:f.title}),t.jsx("p",{className:"text-xs text-muted",children:f.category})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"rounded-full bg-primary/10 px-3 py-1 text-xs font-semibold text-primary",children:["+",f.starValue??3," estrellas"]}),C&&t.jsx("span",{className:"inline-flex items-center gap-1 rounded-full bg-success/10 px-3 py-1 text-xs font-semibold text-success",children:"Completado"})]})]}),b]})}function _e({step:f,onComplete:m,completed:M}){const[C,b]=S.useState(!1),k=()=>{M||C||(b(!0),m({stars:f.starValue??3,attempts:1}))};return t.jsxs("div",{className:"flex flex-col gap-4",children:[t.jsxs("article",{className:"rounded-2xl border border-white/60 bg-white/90 p-4 text-sm text-ink shadow-sm sm:p-6",children:[t.jsxs("h2",{className:"mb-3 flex items-center gap-2 text-base font-semibold text-primary",children:[t.jsx(X,{size:18})," LEE el siguiente texto"]}),t.jsx("p",{className:"whitespace-pre-wrap leading-relaxed text-muted",children:f.content})]}),t.jsx("button",{type:"button",onClick:k,disabled:M||C,className:"btn w-full max-w-xs self-start px-6 py-2 text-sm",children:M||C?"Listo":f.actionLabel??"Continuar"})]})}function Be({step:f,onSuccess:m,completed:M,reading:C}){const[b,k]=S.useState(new Set),[D,L]=S.useState(0),[F,E]=S.useState("idle"),[N,O]=S.useState(!1),[H,V]=S.useState(!1),G=S.useMemo(()=>{const a=[...f.options];for(let g=a.length-1;g>0;g--){const j=Math.floor(Math.random()*(g+1));[a[g],a[j]]=[a[j],a[g]]}return a},[f]);S.useEffect(()=>{k(new Set),L(0),E("idle"),O(!1),V(!1)},[f.id,M]);const _=S.useMemo(()=>new Set(f.options.filter(a=>a.correct).map(a=>a.id)),[f.options]),h=_.size>1,J=f.hint??Fe[f.category]??Ae,Z=a=>{M||(E("idle"),k(g=>{const j=new Set(g);return h?(j.has(a)?j.delete(a):j.add(a),j):new Set([a])}))},q=()=>{if(b.size===0||M)return;const a=D+1;L(a);let g=!1;if(h)b.size===_.size&&(g=Array.from(b).every(j=>_.has(j)));else{const[j]=Array.from(b);g=j!==void 0&&_.has(j)}g?(E("correct"),V(!1),m({stars:a===1?3:a===2?2:1,attempts:a})):E("incorrect")},K=a=>b.has(a),p=M||F==="correct";return t.jsxs("div",{className:"flex flex-col gap-4",children:[C&&t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("button",{type:"button",onClick:()=>O(a=>!a),className:"inline-flex items-center gap-2 self-start rounded-full border border-primary/40 bg-white/80 px-4 py-2 text-xs font-semibold text-primary shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary",children:[t.jsx(X,{size:16}),N?"Ocultar lectura":"Volver a leer"]}),N&&t.jsxs("article",{className:"rounded-2xl border border-primary/20 bg-white/90 p-4 text-sm text-ink shadow-sm sm:p-5",children:[t.jsx("h3",{className:"mb-2 text-sm font-semibold text-primary",children:C.title}),t.jsx("p",{className:"whitespace-pre-wrap leading-relaxed text-muted",children:C.content}),t.jsx("button",{type:"button",onClick:()=>O(!1),className:"mt-2 text-xs font-semibold text-primary underline underline-offset-4",children:"Cerrar lectura"})]})]}),t.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[t.jsx("p",{className:"text-base font-semibold text-ink",children:f.prompt}),t.jsxs("button",{type:"button",onClick:()=>V(a=>!a),className:"btn hint self-start sm:self-auto",children:[t.jsx(z,{size:14}),H?"Ocultar pista":"Ver pista"]})]}),f.note&&t.jsx("p",{className:"text-sm text-muted",children:f.note}),H&&t.jsxs("div",{className:"hint-popover",role:"status","aria-live":"polite",children:[t.jsxs("div",{className:"hint-popover__header",children:[t.jsx(z,{size:12}),"Pista"]}),t.jsx("p",{className:"text-sm text-muted",children:J}),t.jsx("div",{className:"hint-popover__actions",children:t.jsx("button",{type:"button",onClick:()=>V(!1),className:"btn hint",children:"Entendido"})})]}),t.jsx("div",{className:"grid gap-3",children:G.map(a=>{const g=K(a.id),j=F==="correct"&&a.correct,Y=F==="incorrect"&&g&&!a.correct;return t.jsxs("button",{type:"button",onClick:()=>Z(a.id),className:`flex items-center justify-between rounded-[18px] border-2 px-4 py-3 text-left text-sm transition shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-primary/60 ${g?"border-primary bg-primary/10 text-primary shadow-md ring-2 ring-primary/30":"border-white/80 bg-white/90 text-ink hover:border-primary/50 hover:ring-2 hover:ring-primary/20"} ${j?"border-success bg-success/10 text-success ring-2 ring-success/40":""} ${Y?"border-error bg-error/10 text-error ring-2 ring-error/40":""}`,disabled:p,children:[t.jsx("span",{children:a.text}),a.helper&&t.jsx("span",{className:"text-xs text-muted",children:a.helper})]},a.id)})}),t.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[t.jsx("button",{type:"button",onClick:q,className:"btn px-6 py-2 text-sm",disabled:b.size===0||p,children:"Verificar"}),F==="correct"&&t.jsx("span",{className:"text-sm font-semibold text-success",children:"Excelente, continua."}),F==="incorrect"&&t.jsx("span",{className:"text-sm text-error",children:"Revisa la informacion y vuelve a intentarlo."})]})]})}export{Ze as default};
